# Oracle Database : Basic Data Structure

날짜: 2021년 7월 1일

데이터베이스의 물리적 저장 공간은 **테이블스페이스, 세그먼트, 익스텐트, 오라클 블록**의 **논리적 개념**으로 설계되며 이들은 OS블록의 형태인 **물리적인 데이터 파일**의 형태로 최종적으로 구성된다.

하나의 데이터베이스는 여러개의 테이블스페이스로 이루어지고 각각의 테이블스페이스는 여러개의 세그먼트로, 또 각각의 세그먼트는 여러개의 익스텐트로 이루어지고, 하나의 익스텐트는 여러개의 오라클 블록으로 이루어 진다.

**테이블 스페이스**

- 하나의 데이터베이스는 하나 또는 다수의 테이블스페이스라는 논리적 공간으로 이루어진다.
- 하나의 테이블스페이스는 하나의 데이터베이스에 속해야 한다.
- 하나의 테이블스페이스는 한 개 또는 다수의 데이터 파일로 이루어 진다.
	- ex) C:\Data\User1.dbf , D:\User2.def 가 합쳐져서 이루어진다. 즉, 논리적 저장구조와 실제 저장되는 경로나 파일 이름 등의 물리적 저장구조는 서로 영향이 없음

**데이터 파일**

- 하나의 데이터 파일이 여러 가지의 테이블스페이스 데이터를 저장할 수 없다
- DBA는 데이터베이스를 생성한 이후 데이터 파일의 크기를 변경할 수 있다.
- 자동확장기능이 있다.

**세그먼트**

- 하나의 테이블스페이스 내부에 저장된 각 데이터베이스 오브젝트를 세그먼트라고 말할 수 있다. Data, Index, Tmeporary, Undo 와 같은 종류들로 나뉜다. 
- 하나의 테이블스페이스에는 다수의 세그먼트를 저장할 수도 있다.
- 하나의 세그먼트가 다수의 테이블스페이스에 나누어 저장될 수 없다.
- 하나의 세그먼트는 다수의 데이터 파일에 나누어 저장될 수도 있다. 단 그 데이터 파일들이 같은 테이블스페이스 내부에 할당되어 있는 경우에만 가능하다.

**익스텐트**

- 하나의 세그먼트에 할당된 공간을 익스텐트라 한다.
- 하나의 세그먼트는 한 개 또는 다수의 익스텐트로 구성된다.
- 하나의 세그먼트가 다수의 데이터 파일에 나누어 저장될 수 없다.

**오라클 블록**

- 오라클의 기본 I/O 단위로서 모든 데이터는 Block으로 이루어져 있다. 기본 I/O 단위라는 말은 DB에서 데이터를 검색할 때에 아주 작은 데이터 하나만 찾으려고 해도 최소 하나의 Block 에 저장된 전체 데이터에 대해 스캔이 이루어진다는 뜻이다.
- DB를 구성하는 가장 최소 저장 공간으로 실제 데이터가 바로 이곳에 저장된다.
- 오라클 블록의 크기는 db_block_size라는 파라미터에 의해 정해지며 변경이 불가능하다.
- 다른 블록사이즈를 사용하고자 한다면 테이블스페이스를 추가로 생성하면서 다른 크기로 설정 가능하다.
- Block Header, Free Space, Row Data 세가지로 이루어진다. 
	1. Block Header : Top-Down 방식으로 Header 정보가 증가하며, Bottom-Top 방식으로 데이터가 증가한다. 
		- Block Address : 데이터가 테이터 파일의 몇 번째 블록에 있는지 알려주는 주소값
		- Data Block Address : 테이블 스페이스 내에서 몇번째 블록에 있는지 알려주는 주소값
		- Segment Type : 이 블록의 오브젝트가 테이블인지 인덱스인지
		- Row Directory : 해당 데이트 블록 내 Row들의 주소값
		- Table Directory : 해당 데이터 블록의 Segment 정보
		- Transaction Slots : 해당 데이터 블록에 존재하는 Row에 대해 DML을 수행하기 위해 획득해야하는 요소
	![DataBlock](https://github.com/leeho1110/TIL/raw/master/img/oracleBlock.png)
